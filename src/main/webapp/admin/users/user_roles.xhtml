<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
    <h:body >
        <ui:composition template="/admin/users/index.xhtml">
            <ui:define name="subcontent">
                <p:panel >
                    <f:facet name="header">
                        <i class="fa fa-user" aria-hidden="true"/>
                        <h:outputText value="View Users" class="mx-2"/>
                    </f:facet>
                    <h:panelGroup rendered="#{!webUserController.hasPrivilege('AdminManagingUsers') and !sessionController.firstLogin }" >
                        <h:outputText value="You are NOT authorized"/>
                    </h:panelGroup>
                    <h:panelGroup rendered="#{webUserController.hasPrivilege('AdminManagingUsers') or sessionController.firstLogin }" >
                        <h:form  >

                            <div class="container-fluid p-2" >
                                <div class="row" >
                                    <div class="col-md-9" >
                                        <ui:insert name="users" >
                                            <div class="row" >
                                                <div class="col-6" >
                                                    <p:selectOneListbox 
                                                        id="lstItems"
                                                        value="#{webUserRoleController.current}"
                                                        filter="true"
                                                        filterMatchMode="contains">
                                                        <f:selectItems 
                                                            value="#{webUserRoleController.items}" 
                                                            var="i" 
                                                            itemLabel="#{i.name}" 
                                                            itemValue="#{i}" >
                                                        </f:selectItems>
                                                        <p:ajax process="lstItems" update="gridDetails" ></p:ajax>
                                                    </p:selectOneListbox>
                                                    <p:commandButton 
                                                        id="btnAdd"
                                                        value="Add New" 
                                                        process="btnAdd"
                                                        update="gridDetails"
                                                        action="#{webUserRoleController.toAddNewUserRole}">
                                                    </p:commandButton>
                                                </div>
                                                <div class="col-6" >
                                                    <p:panelGrid 
                                                        id="gridDetails"
                                                        columns="2" class="w-100">
                                                        <p:outputLabel value="Role Name" for="txtRole" ></p:outputLabel>
                                                        <p:inputText
                                                            value="#{webUserRoleController.current.name}" 
                                                            id="txtRole" 
                                                            required="true" 
                                                            requiredMessage="Please enter a Name" >
                                                        </p:inputText>
                                                        <p:outputLabel value="Description" for="txtComments" ></p:outputLabel>
                                                        <p:inputTextarea
                                                            value="#{webUserRoleController.current.description}" 
                                                            id="txtComments" 
                                                            required="true" 
                                                            requiredMessage="Please enter a Name" >
                                                        </p:inputTextarea>
                                                    </p:panelGrid>
                                                    <p:commandButton
                                                        id="btnSave"
                                                        process="gridDetails btnSave"
                                                        update="lstItems"
                                                        value="Save" 
                                                        action="#{webUserRoleController.saveCurrent()}" ></p:commandButton>
                                                </div>
                                            </div>

                                        </ui:insert>
                                    </div>

                                    <h:panelGroup id="actions" class="col-md-3 col-md-3 d-flex flex-column" >

                                        <p:commandButton ajax="false"
                                                         disabled="#{webUserController.selected == null}" 
                                                         icon="fa fa-trash" 
                                                         value="Remove" 
                                                         class="m-1 ui-button-danger" 
                                                         onclick="if (!confirm('Are you sure you want to Remove User?'))
                                                                     return false;" action="#{webUserController.removeUser}" />

                                        <p:commandButton disabled="#{webUserController.selected == null}" icon="fa fa-user-cog" value="Manage User" class="m-1" action="#{webUserController.navigateToEditUser()}" ajax="false" />
                                        <p:commandButton disabled="#{webUserController.selected == null}" icon="fa fa-key" value="Manage Password" class="m-1" action="#{webUserController.navigateToEditPasswordByAdmin()}" ajax="false" />
                                        <p:commandButton disabled="#{webUserController.selected == null}" icon="fa fa-users-cog" value="Manage Staff" class="m-1" action="#{webUserController.navigateToManageStaff()}" ajax="false" />
                                        <p:commandButton disabled="#{webUserController.selected == null}" icon="fa fa-building" value="Manage User Departments" class="m-1" action="#{webUserController.navigateToManageDepartments()}" ajax="false" />
                                        <p:commandButton disabled="#{webUserController.selected == null}" icon="fa fa-unlock-alt" value="Manage Privileges" class="m-1" action="#{webUserController.navigateToManagePrivileges()}" ajax="false" />
                                        <p:commandButton disabled="#{webUserController.selected == null}" icon="fa fa-credit-card" value="Manage User Payment Schemes" class="m-1" action="#{webUserController.navigateToManagePaymentSchemes()}" ajax="false" />
                                        <p:commandButton disabled="#{webUserController.selected == null}" icon="fa fa-icons" value="Manage User Icons" class="m-1" action="#{webUserController.navigateToManageUserIcons()}" ajax="false" />
                                        <p:commandButton disabled="#{webUserController.selected == null}" icon="fas fa-rss" value="Manage User Subscriptions" class="m-1" action="#{webUserController.navigateToManageUserSubscriptions()}" ajax="false" />
                                        <p:commandButton disabled="#{webUserController.selected == null}" icon="fa fa-signature" value="Manage Signature" class="m-1" action="#{webUserController.toManageSignature()}" ajax="false" />
                                        <p:commandButton disabled="#{webUserController.selected == null}" icon="fa fa-tachometer-alt" value="Manage Dashboards" class="m-1" action="#{webUserController.toManageDashboards()}" ajax="false" />
                                        <p:commandButton disabled="#{webUserController.selected == null}" icon="fa fa-tachometer-alt" value="Manage Preferences" class="m-1" action="#{webUserController.toManageUserPreferences()}" ajax="false" />

                                    </h:panelGroup>
                                </div>
                            </div>
                        </h:form>
                    </h:panelGroup>
                </p:panel>
            </ui:define>
        </ui:composition>
    </h:body>
</html>