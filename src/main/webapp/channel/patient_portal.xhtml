<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="/resources/template/template.xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:ch="http://xmlns.jcp.org/jsf/composite/channel"
                xmlns:pa="http://xmlns.jcp.org/jsf/composite/paymentMethod"
                xmlns:au="http://xmlns.jcp.org/jsf/composite/autocomplete"
                xmlns:pat="http://xmlns.jcp.org/jsf/composite/patient"
                xmlns:ez="http://xmlns.jcp.org/jsf/composite/ezcomp">

    <ui:define name="content">
        <h:form id="form">
            <p:inputText value="#{patientPortalController.patientphoneNumber}" />
            <p:commandButton ajax="false" 
                        value="Send Now" 
                        class="ui-button-success"
                        action="#{patientPortalController.sendOtp}"/>
            
             <p:inputText value="#{patientPortalController.patientEnteredOtp}" />
            <p:commandButton ajax="false" 
                        value="Verify" 
                        class="ui-button-success"
                        action="#{patientPortalController.sendOtp}"/> 
            <p:panel>
                <div class="d-flex justify-content-center align-items-center">
                    <p:commandButton 
                        ajax="false" 
                        value="Book" 
                        icon="fas fa-plus"
                        class="ui-button-success"
                        action="#{patientPortalController.docotrBooking}"
                        />
                </div>
                <div class="row">
                    <div class="col-2">
                        <div>
                            <p:watermark for="scStaff" value="Select Consultant" ></p:watermark>
                            <p:selectOneListbox 
                                id="scStaff"
                                filter="true"
                                value="#{patientPortalController.selectedConsultant}"
                                class="w-100 fullHeightListbox"
                                >
                                <p:ajax  
                                    process="@this" 
                                    update="acSessions sessionDates"  
                                    listener="#{patientPortalController.fillChannelSessions}"/>
                                <f:selectItems value="#{patientPortalController.consultants}"
                                               var="con" 
                                               itemValue="#{con}"
                                               itemLabel="#{con.name}"></f:selectItems>
                            </p:selectOneListbox>
                        </div>
                    </div>

                    <div class="col-md-4 p-0" >
                        <p:watermark for="acSessions" value="Select Session" ></p:watermark>
                        <p:selectOneListbox 
                            id="acSessions"
                            filter="true"
                            value="#{patientPortalController.selectedChannelSession}" 
                            class="w-100 fullHeightListbox"
                            var="s">
                            <p:ajax  
                                process="@this" 
                                update=":#{p:resolveFirstComponentWithId('sessionDates',view).clientId}"  
                                listener="#{patientPortalController.fillSessionInstance()}"/>
                            <f:selectItems 
                                value="#{patientPortalController.channelSessions}" 
                                var="ses" 
                                itemValue="#{ses}"
                                itemLabel="#{ses.name}"/>
                            <p:column>
                                <h:outputText value="#{s.name}" />
                            </p:column>

                        </p:selectOneListbox>
                    </div>

                    <div class="col-md-4 p-0" >
                        <p:watermark for="sessionDates" value="Select Session" ></p:watermark>
                        <p:selectOneListbox 
                            id="sessionDates"
                            filter="true"
                            value="#{bookingController.selectedSessionInstance}" 
                            class="w-100 fullHeightListbox"
                            var="s">
                            <f:selectItems 
                                value="#{patientPortalController.sessionInstances}" 
                                var="ses" 
                                itemValue="#{ses}"
                                itemLabel="#{ses.name}"/>
                            <p:column>
                                <h:outputText value="#{s.name}" />
                            </p:column>
                            <p:column style="width: 20px!important; text-align: center;">
                                <h:outputText value="#{s.maxNo}" rendered="#{s.maxNo ne 0}">
                                    <f:convertNumber pattern="00" />
                                </h:outputText>
                            </p:column>
                            <p:column style="width: 20px!important; text-align: center;">
                                <h:outputText value="#{s.displayCount}">
                                    <f:convertNumber pattern="00" />
                                </h:outputText>
                            </p:column>
                            <p:column style="width: 50px!important; text-align: center;">
                                <h:outputText value="#{s.sessionDate}">
                                    <f:convertDateTime pattern="dd MMM"/>
                                </h:outputText>
                            </p:column>
                            <p:column style="width: 40px!important; text-align: center;">
                                <h:outputText value="#{s.startingTime}">
                                    <f:convertDateTime pattern="hh:mm"/>
                                </h:outputText>
                            </p:column>
                            <p:column style="width: 40px!important; text-align: center;">
                                <h:outputText value="#{s.totalFee}">
                                    <f:convertNumber pattern="#,##0" />
                                </h:outputText>
                            </p:column>

                        </p:selectOneListbox>
                    </div>

                </div>
                <div class="d-flex justify-content-center align-items-center">
                    <p:commandButton 
                        ajax="false" 
                        value="Watch Booking History" 
                        icon="fas fa-plus"
                        class="ui-button-success"
                        action="#{patientPortalController.docotrBooking}"
                        />
                    <p:commandButton 
                        ajax="false" 
                        value="Watch Payment History" 
                        icon="fas fa-plus"
                        class="ui-button-success"
                        action="#{patientPortalController.docotrBooking}"
                        />
                     <p:commandButton 
                        ajax="false" 
                        value="Book" 
                        icon="fas fa-plus"
                        class="ui-button-danger"
                        action="#{patientPortalController.docotrBooking}"
                        />
                </div>
                
                

            </p:panel>
        </h:form>
    </ui:define>
</ui:composition>